# Operational Upgrade - Svoi Server

## –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

–í –≤–∞—à –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π Svoi Server –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

### üìÅ –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫

```
Svoi Server/
‚îú‚îÄ‚îÄ runbooks/              # –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã (SOP)
‚îÇ   ‚îú‚îÄ‚îÄ 01-no-frames.md
‚îÇ   ‚îú‚îÄ‚îÄ 02-queue-spike.md
‚îÇ   ‚îú‚îÄ‚îÄ 03-decode-errors-spike.md
‚îÇ   ‚îú‚îÄ‚îÄ 04-db-slow.md
‚îÇ   ‚îú‚îÄ‚îÄ 05-api-5xx-spike.md
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ templates/             # –®–∞–±–ª–æ–Ω—ã –¥–ª—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ INCIDENT_TEMPLATE.md
‚îÇ   ‚îî‚îÄ‚îÄ POSTMORTEM_TEMPLATE.md
‚îú‚îÄ‚îÄ alerts/                # Prometheus –∞–ª–µ—Ä—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ prometheus-rules.yml
‚îú‚îÄ‚îÄ playbooks/             # –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ smoke.sh
‚îî‚îÄ‚îÄ Makefile              # –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏
```

### üöÄ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

#### 1. **Runbooks (SOP)**
- –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
- –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏
- –ß–µ–∫-–ª–∏—Å—Ç—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- –ü—Ä–æ—Ü–µ–¥—É—Ä—ã –º–∏—Ç–∏–≥–∞—Ü–∏–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

#### 2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã**
- Prometheus –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º
- –ê–ª–µ—Ä—Ç—ã –ø–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –º–µ—Ç—Ä–∏–∫–∞–º
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å runbooks

#### 3. **Smoke tests**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

#### 4. **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**
- `make help` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
- `make smoke-test` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
- `make runbook-*` - –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ü–µ–¥—É—Ä
- `make emergency-*` - —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

### üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ runbooks

1. **01-no-frames.md** - –ù–µ—Ç –∫–∞–¥—Ä–æ–≤ –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤
   - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ TCP —Å–µ—Ä–≤–µ—Ä–∞
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

2. **02-queue-spike.md** - –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã
   - –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
   - –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

3. **03-decode-errors-spike.md** - –û—à–∏–±–∫–∏ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä–µ–π
   - –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞

4. **04-db-slow.md** - –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ë–î
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
   - –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤

5. **05-api-5xx-spike.md** - –û—à–∏–±–∫–∏ API
   - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ API –ø—Ä–æ–±–ª–µ–º
   - –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞

### üõ†Ô∏è –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
make health-check

# –ó–∞–ø—É—Å–∫ smoke test
make smoke-test

# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
make help

# –ü—Ä–æ—Å–º–æ—Ç—Ä runbook
make runbook-no-frames

# –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
make emergency-restart
```

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

#### Prometheus –∞–ª–µ—Ä—Ç—ã
- **ServerDown** - —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- **HighCpuUsage** - –≤—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CPU
- **HighMemoryUsage** - –≤—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–∞–º—è—Ç–∏
- **NoFrames** - –Ω–µ—Ç –∫–∞–¥—Ä–æ–≤ –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **HighErrorRate** - –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –æ—à–∏–±–æ–∫
- **QueueLengthHigh** - –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏

#### Smoke test –ø—Ä–æ–≤–µ—Ä–∫–∏
- –°—Ç–∞—Ç—É—Å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
- –ó–¥–æ—Ä–æ–≤—å–µ —Å–µ—Ä–≤–µ—Ä–∞
- API –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
- TCP —Å–µ—Ä–≤–µ—Ä
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- –õ–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏

### üîß –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
make start          # –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
make stop           # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
make restart        # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
make status         # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
make logs           # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
make test           # –í—Å–µ —Ç–µ—Å—Ç—ã
make test-client    # –¢–µ—Å—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞
make test-api       # –¢–µ—Å—Ç—ã API
make smoke-test     # Smoke test
```

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
make health-check   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
make monitor        # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
make metrics        # –ú–µ—Ç—Ä–∏–∫–∏
make alerts         # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
```

#### –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
```bash
make emergency-restart  # –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
make emergency-logs     # –°–±–æ—Ä –ª–æ–≥–æ–≤
make emergency-status   # –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
```

#### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
```bash
make daily-ops      # –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
make security-check # –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
make perf-check     # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
make maintenance    # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
```

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **README.md** - –æ–±–Ω–æ–≤–ª–µ–Ω —Å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏
- **runbooks/README.md** - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ runbooks
- **templates/** - —à–∞–±–ª–æ–Ω—ã –¥–ª—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
- **Makefile** - –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ò–∑—É—á–∏—Ç–µ runbooks** - –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º–∏
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ø–æ–¥–∫–ª—é—á–∏—Ç–µ Prometheus
3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ smoke test** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏—Å—Ç–µ–º—É
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ –∑–∞–¥–∞—á–∏
5. **–ü—Ä–æ–≤–µ–¥–∏—Ç–µ —É—á–µ–Ω–∏—è** - –æ—Ç—Ä–∞–±–æ—Ç–∞–π—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã

### üí° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- **–ë—ã—Å—Ç—Ä–æ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã** –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–±–ª–µ–º
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
- **–î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –¥–ª—è –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å** –æ–ø–µ—Ä–∞—Ü–∏–π

–í–∞—à Svoi Server —Ç–µ–ø–µ—Ä—å –≥–æ—Ç–æ–≤ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π!

